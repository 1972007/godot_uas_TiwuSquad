[gd_scene load_steps=7 format=2]

[ext_resource path="res://src/game/hud/debug_showhide.gd" type="Script" id=1]
[ext_resource path="res://textures/enemy_placeholder.png" type="Texture" id=2]
[ext_resource path="res://src/game/enemies/ShadedEnemy.gd" type="Script" id=3]

[sub_resource type="Shader" id=2]
code = "shader_type canvas_item;

const float pi = 3.14156;

uniform float dist = 16.;
uniform float alpha : hint_range(0., 1.) = 1.;

void fragment() {
	vec2 backgroundUV = FRAGCOORD.xy * SCREEN_PIXEL_SIZE.xy;
	
	vec2 offsetR = vec2(dist * SCREEN_PIXEL_SIZE.x * cos(TIME * 2. * pi),        dist * SCREEN_PIXEL_SIZE.x * cos(TIME*0.7 * 2. * pi));
	vec2 offsetG = vec2(dist * SCREEN_PIXEL_SIZE.x * cos(1. + (TIME * 2. * pi)), dist * SCREEN_PIXEL_SIZE.x * cos(3. + (TIME*0.7 * 2. * pi)));
	vec2 offsetB = vec2(dist * SCREEN_PIXEL_SIZE.x * cos(TIME * 1.5 * pi),       dist * SCREEN_PIXEL_SIZE.x * cos(TIME*0.9 * 2. * pi));
	
	vec4 backColR = texture(SCREEN_TEXTURE, SCREEN_UV + offsetR);
	vec4 backColG = texture(SCREEN_TEXTURE, SCREEN_UV + offsetG);
	vec4 backColB = texture(SCREEN_TEXTURE, SCREEN_UV + offsetB);
	
	vec4 texCol = texture(TEXTURE, UV);
	
	COLOR = mix(texCol, texCol.a * vec4(backColR.r, backColG.g, backColB.b, 1.0), alpha);
}"

[sub_resource type="ShaderMaterial" id=3]
shader = SubResource( 2 )
shader_param/dist = 16.0
shader_param/alpha = 1.0

[sub_resource type="RectangleShape2D" id=4]
extents = Vector2( 16, 16 )

[node name="ShadedEnemy" type="KinematicBody2D"]
script = ExtResource( 3 )

[node name="EnemyModel" type="Sprite" parent="."]
material = SubResource( 3 )
position = Vector2( 4.76837e-07, 4.76837e-07 )
scale = Vector2( 2, 2 )
texture = ExtResource( 2 )

[node name="DebugPathfinding" type="Line2D" parent="."]
width = 2.0
default_color = Color( 1, 0.984314, 0, 1 )
texture_mode = -1082211219
script = ExtResource( 1 )

[node name="Timer" type="Timer" parent="."]
wait_time = 5.0

[node name="CollisionShape2D" type="CollisionShape2D" parent="."]
shape = SubResource( 4 )

[connection signal="timeout" from="Timer" to="." method="_on_Timer_timeout"]
